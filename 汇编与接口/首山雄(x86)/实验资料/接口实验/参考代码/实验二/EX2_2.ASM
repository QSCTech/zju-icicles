.MODEL SMALL
.DATA
ADDRESS DW ?
DISPLAY	DB '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'
DELAY	DW 0H,0H,0H,0H
SET_C	DB 0E0H,0D0H,0B0H,70H
TEST_C	DB 1H,2H,4H,8H
.CODE
.STARTUP
MOV AH,0B1H
MOV AL,02H
MOV CX,8376H
MOV DX,10EBH
MOV SI,0
INT 1AH

MOV AH,0B1H
MOV AL,09H
MOV DI,1CH
INT 1AH

AND CX,0FFFCH
MOV ADDRESS,CX

MOV DX,ADDRESS
ADD DX,3H
MOV AL,10000001B
OUT DX,AL
LP:	MOV DX,ADDRESS
	ADD DX,2H
	MOV BX,0H
		
ROWLP:	MOV AL,SET_C[BX]
	OUT DX,AL
	
	IN  AL,DX
	OR  AL,0F0H
	XOR AL,0FFH
	.IF AL!=0
	
	MOV DI,0H
COLLP:	MOV AH,TEST_C[DI]
	TEST AL,AH
	JNZ ADDI
	ADD DI,1H
	.IF DI<4H
	JMP COLLP
	.ENDIF
	
	.ENDIF
	
	ADD BX,1H
	.IF BX<4H
	JMP ROWLP
	.ENDIF
	JMP LP

ADDI:	MOV AX,DELAY[DI]
	ADD AX,1H
	MOV DELAY[DI],AX
	.IF AX>1000H
	JMP DISP
	.ENDIF
	JMP LP

DISP:	SHL BX,1
	SHL BX,1
	MOV DL,DISPLAY[BX+DI]
	MOV AH,02H
	INT 21H
	MOV DELAY[DI],0H
	JMP LP

.EXIT
END