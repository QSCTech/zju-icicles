.MODEL SMALL
.DATA
ADDRESS DW ?
DISPLAY	DB '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'
DELAY	DW 0H
SET_C	DB 0E0H,0D0H,0B0H,70H
TEST_C	DB 1H,2H,4H,8H
.CODE
.STARTUP
MOV AH,0B1H
MOV AL,02H
MOV CX,8376H
MOV DX,10EBH
MOV SI,0
INT 1AH

MOV AH,0B1H
MOV AL,09H
MOV DI,1CH
INT 1AH

AND CX,0FFFCH
MOV ADDRESS,CX

MOV DX,ADDRESS
ADD DX,3H
MOV AL,10000001B
OUT DX,AL
	MOV DX,ADDRESS
	ADD DX,2H

LP:	MOV BX,0H		
ROWLP:	MOV AL,SET_C[BX]
	OUT DX,AL

	MOV DI,0H
COLLP:	IN  AL,DX
	OR  AL,0F0H
	XOR AL,0FFH
	MOV AH,TEST_C[DI]
	CMP AL,AH
	JNZ ADD_DI

	INC DELAY
	CMP DELAY,2000H
	JA SET_DL
	JB COLLP
	CALL DISP
	JMP COLLP
SET_DL:	MOV DELAY,2000H
	JMP COLLP
	
ADD_DI:	MOV DELAY,0H
	ADD DI,1H
	CMP DI,4H		;.IF DI<4H
	JB COLLP
	
	ADD BX,1H
	CMP BX,4H		;.IF BX<4H
	JB ROWLP
	JMP LP

DISP	PROC
	PUSH DX
	PUSH BX
	PUSH AX
	SHL BX,1
	SHL BX,1
	MOV DL,DISPLAY[BX+DI]
	MOV AH,02H
	INT 21H
	POP  AX
	POP  BX
	POP  DX
	RET
DISP	ENDP
.EXIT
END